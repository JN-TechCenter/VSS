# ğŸ”§ è¿ç»´æ“ä½œæŒ‡å—

## ğŸ“‹ ç›®å½•æ¦‚è¿°

æœ¬ç›®å½•åŒ…å«VSSé¡¹ç›®çš„è¿ç»´æ“ä½œæŒ‡å—ï¼Œä¸ºè¿ç»´å·¥ç¨‹å¸ˆå’ŒDevOpså›¢é˜Ÿæä¾›ç³»ç»Ÿè¿ç»´çš„å®Œæ•´æŒ‡å¯¼ã€‚

**ç›®æ ‡å—ä¼—**: è¿ç»´å·¥ç¨‹å¸ˆã€DevOpså·¥ç¨‹å¸ˆã€ç³»ç»Ÿç®¡ç†å‘˜ã€æŠ€æœ¯è´Ÿè´£äºº

---

## ğŸ“ æ–‡æ¡£ç»“æ„

### æ ¸å¿ƒè¿ç»´æ–‡æ¡£

| æ–‡æ¡£ç±»å‹ | æ–‡æ¡£åç§° | çŠ¶æ€ | ä¼˜å…ˆçº§ |
|----------|----------|------|--------|
| **ç›‘æ§å‘Šè­¦** | [monitoring-alerting.md](./monitoring-alerting.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸ”´ é«˜ |
| **æ—¥å¿—ç®¡ç†** | [logging-management.md](./logging-management.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸ”´ é«˜ |
| **å¤‡ä»½æ¢å¤** | [backup-recovery.md](./backup-recovery.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸ”´ é«˜ |
| **æ€§èƒ½è°ƒä¼˜** | [performance-tuning.md](./performance-tuning.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸŸ¡ ä¸­ |

### æ•…éšœå¤„ç†æ–‡æ¡£

| æ–‡æ¡£ç±»å‹ | æ–‡æ¡£åç§° | çŠ¶æ€ | ä¼˜å…ˆçº§ |
|----------|----------|------|--------|
| **æ•…éšœæ’æŸ¥** | [troubleshooting-guide.md](./troubleshooting-guide.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸ”´ é«˜ |
| **åº”æ€¥å“åº”** | [incident-response.md](./incident-response.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸ”´ é«˜ |
| **å¸¸è§é—®é¢˜** | [faq-operations.md](./faq-operations.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸŸ¡ ä¸­ |

### ç»´æŠ¤æ“ä½œæ–‡æ¡£

| æ–‡æ¡£ç±»å‹ | æ–‡æ¡£åç§° | çŠ¶æ€ | ä¼˜å…ˆçº§ |
|----------|----------|------|--------|
| **ç³»ç»Ÿç»´æŠ¤** | [system-maintenance.md](./system-maintenance.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸŸ¡ ä¸­ |
| **å®‰å…¨è¿ç»´** | [security-operations.md](./security-operations.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸ”´ é«˜ |
| **å®¹é‡è§„åˆ’** | [capacity-planning.md](./capacity-planning.md) | ğŸ“‹ è®¡åˆ’ä¸­ | ğŸŸ¢ ä½ |

---

## ğŸ—ï¸ è¿ç»´æ¶æ„æ¦‚è§ˆ

### ç›‘æ§ä½“ç³»æ¶æ„

```mermaid
graph TB
    subgraph "ğŸ“Š ç›‘æ§æ•°æ®æ”¶é›†"
        A[Prometheus<br/>æŒ‡æ ‡æ”¶é›†]
        B[Grafana<br/>å¯è§†åŒ–å±•ç¤º]
        C[AlertManager<br/>å‘Šè­¦ç®¡ç†]
        D[Node Exporter<br/>ç³»ç»ŸæŒ‡æ ‡]
    end
    
    subgraph "ğŸ“ æ—¥å¿—ç®¡ç†"
        E[ELK Stack<br/>æ—¥å¿—æ”¶é›†åˆ†æ]
        F[Filebeat<br/>æ—¥å¿—é‡‡é›†]
        G[Logstash<br/>æ—¥å¿—å¤„ç†]
        H[Elasticsearch<br/>æ—¥å¿—å­˜å‚¨]
    end
    
    subgraph "ğŸ”” å‘Šè­¦é€šçŸ¥"
        I[é’‰é’‰æœºå™¨äºº<br/>å³æ—¶é€šçŸ¥]
        J[é‚®ä»¶å‘Šè­¦<br/>è¯¦ç»†æŠ¥å‘Š]
        K[çŸ­ä¿¡å‘Šè­¦<br/>ç´§æ€¥é€šçŸ¥]
    end
    
    subgraph "ğŸ¯ VSSæœåŠ¡"
        L[VSS-frontend<br/>:3000]
        M[VSS-backend<br/>:8080]
        N[inference-server<br/>:8000]
        O[net-framework-server<br/>:9000]
        P[data-analysis-server<br/>:7000]
    end
    
    L --> A
    M --> A
    N --> A
    O --> A
    P --> A
    
    L --> F
    M --> F
    N --> F
    O --> F
    P --> F
    
    A --> B
    A --> C
    F --> G
    G --> H
    
    C --> I
    C --> J
    C --> K
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style C fill:#fce4ec
    style E fill:#e8f5e8
    style I fill:#fff3e0
```

### è¿ç»´å·¥å…·é“¾

| å·¥å…·ç±»å‹ | å·¥å…·åç§° | ç‰ˆæœ¬ | ç”¨é€” | é…ç½®æ–‡ä»¶ |
|----------|----------|------|------|----------|
| **å®¹å™¨ç¼–æ’** | Docker Compose | 2.x | æœåŠ¡ç¼–æ’ | `docker-compose.yml` |
| **ç›‘æ§æŒ‡æ ‡** | Prometheus | 2.40+ | æŒ‡æ ‡æ”¶é›† | `prometheus.yml` |
| **å¯è§†åŒ–** | Grafana | 9.x | ç›‘æ§é¢æ¿ | `grafana.ini` |
| **å‘Šè­¦ç®¡ç†** | AlertManager | 0.25+ | å‘Šè­¦è·¯ç”± | `alertmanager.yml` |
| **æ—¥å¿—æ”¶é›†** | ELK Stack | 8.x | æ—¥å¿—ç®¡ç† | `elasticsearch.yml` |
| **åå‘ä»£ç†** | Nginx | 1.20+ | è´Ÿè½½å‡è¡¡ | `nginx.conf` |

---

## ğŸ¯ æ ¸å¿ƒè¿ç»´ä»»åŠ¡

### 1. ç›‘æ§å‘Šè­¦ ğŸ“Š

**ç›‘æ§æŒ‡æ ‡**
- **ç³»ç»ŸæŒ‡æ ‡**: CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œ
- **åº”ç”¨æŒ‡æ ‡**: QPSã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- **ä¸šåŠ¡æŒ‡æ ‡**: ç”¨æˆ·æ´»è·ƒåº¦ã€æ¨ç†æˆåŠŸç‡
- **åŸºç¡€è®¾æ–½**: æ•°æ®åº“è¿æ¥ã€ç¼“å­˜å‘½ä¸­ç‡

**å‘Šè­¦è§„åˆ™**
```yaml
# Prometheuså‘Šè­¦è§„åˆ™ç¤ºä¾‹
groups:
  - name: vss-alerts
    rules:
      - alert: HighCPUUsage
        expr: cpu_usage_percent > 80
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "CPUä½¿ç”¨ç‡è¿‡é«˜"
          description: "{{ $labels.instance }} CPUä½¿ç”¨ç‡è¶…è¿‡80%"
      
      - alert: ServiceDown
        expr: up == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "æœåŠ¡ä¸å¯ç”¨"
          description: "{{ $labels.job }} æœåŠ¡å·²åœæ­¢"
```

**ç›‘æ§é¢æ¿**
- **ç³»ç»Ÿæ¦‚è§ˆ**: æ•´ä½“å¥åº·çŠ¶æ€
- **æœåŠ¡è¯¦æƒ…**: å„æœåŠ¡æ€§èƒ½æŒ‡æ ‡
- **ä¸šåŠ¡ç›‘æ§**: å…³é”®ä¸šåŠ¡æŒ‡æ ‡
- **å‘Šè­¦å†å²**: å‘Šè­¦è¶‹åŠ¿åˆ†æ

---

### 2. æ—¥å¿—ç®¡ç† ğŸ“

**æ—¥å¿—æ”¶é›†ç­–ç•¥**
```yaml
# Filebeaté…ç½®ç¤ºä¾‹
filebeat.inputs:
  - type: log
    enabled: true
    paths:
      - /var/log/vss/*.log
    fields:
      service: vss
      environment: production
    multiline.pattern: '^\d{4}-\d{2}-\d{2}'
    multiline.negate: true
    multiline.match: after
```

**æ—¥å¿—æ ¼å¼æ ‡å‡†**
```json
{
  "timestamp": "2025-01-15T10:30:00Z",
  "level": "INFO",
  "service": "vss-backend",
  "trace_id": "abc123",
  "message": "ç”¨æˆ·ç™»å½•æˆåŠŸ",
  "user_id": "12345",
  "ip": "192.168.1.100"
}
```

**æ—¥å¿—åˆ†ææŸ¥è¯¢**
```bash
# æŸ¥è¯¢é”™è¯¯æ—¥å¿—
GET /vss-logs-*/_search
{
  "query": {
    "bool": {
      "must": [
        {"term": {"level": "ERROR"}},
        {"range": {"timestamp": {"gte": "now-1h"}}}
      ]
    }
  }
}

# æŸ¥è¯¢ç‰¹å®šæœåŠ¡æ—¥å¿—
GET /vss-logs-*/_search
{
  "query": {
    "term": {"service": "vss-backend"}
  }
}
```

---

### 3. å¤‡ä»½æ¢å¤ ğŸ’¾

**å¤‡ä»½ç­–ç•¥**
- **æ•°æ®åº“å¤‡ä»½**: æ¯æ—¥å…¨é‡ + æ¯å°æ—¶å¢é‡
- **é…ç½®æ–‡ä»¶å¤‡ä»½**: æ¯æ¬¡å˜æ›´åå¤‡ä»½
- **ä»£ç å¤‡ä»½**: Gitä»“åº“ + é•œåƒä»“åº“
- **æ—¥å¿—å¤‡ä»½**: ä¿ç•™30å¤©ï¼Œå‹ç¼©å­˜å‚¨

**å¤‡ä»½è„šæœ¬**
```bash
#!/bin/bash
# æ•°æ®åº“å¤‡ä»½è„šæœ¬

BACKUP_DIR="/backup/postgresql"
DATE=$(date +%Y%m%d_%H%M%S)
DB_NAME="vss_db"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# æ‰§è¡Œå¤‡ä»½
pg_dump -h localhost -U postgres $DB_NAME > $BACKUP_DIR/vss_db_$DATE.sql

# å‹ç¼©å¤‡ä»½æ–‡ä»¶
gzip $BACKUP_DIR/vss_db_$DATE.sql

# æ¸…ç†7å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "*.sql.gz" -mtime +7 -delete

echo "å¤‡ä»½å®Œæˆ: vss_db_$DATE.sql.gz"
```

**æ¢å¤æµç¨‹**
1. åœæ­¢ç›¸å…³æœåŠ¡
2. æ¢å¤æ•°æ®åº“æ•°æ®
3. æ¢å¤é…ç½®æ–‡ä»¶
4. éªŒè¯æ•°æ®å®Œæ•´æ€§
5. é‡å¯æœåŠ¡
6. åŠŸèƒ½éªŒè¯æµ‹è¯•

---

### 4. æ€§èƒ½è°ƒä¼˜ âš¡

**æ€§èƒ½ç›‘æ§æŒ‡æ ‡**
| æœåŠ¡ | å…³é”®æŒ‡æ ‡ | ç›®æ ‡å€¼ | å‘Šè­¦é˜ˆå€¼ |
|------|----------|--------|----------|
| **Frontend** | é¡µé¢åŠ è½½æ—¶é—´ | < 2s | > 5s |
| **Backend** | APIå“åº”æ—¶é—´ | < 200ms | > 500ms |
| **AI Service** | æ¨ç†å»¶è¿Ÿ | < 100ms | > 300ms |
| **Network** | è¿æ¥æ•° | < 1000 | > 2000 |
| **Database** | æŸ¥è¯¢æ—¶é—´ | < 50ms | > 200ms |

**è°ƒä¼˜ç­–ç•¥**
```bash
# JVMè°ƒä¼˜å‚æ•°
JAVA_OPTS="-Xms2g -Xmx4g -XX:+UseG1GC -XX:MaxGCPauseMillis=200"

# PostgreSQLè°ƒä¼˜
shared_buffers = 256MB
effective_cache_size = 1GB
work_mem = 4MB
maintenance_work_mem = 64MB

# Redisè°ƒä¼˜
maxmemory 1gb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
```

---

## ğŸš¨ æ•…éšœå¤„ç†æµç¨‹

### æ•…éšœåˆ†çº§

| çº§åˆ« | å½±å“èŒƒå›´ | å“åº”æ—¶é—´ | è§£å†³æ—¶é—´ | é€šçŸ¥æ–¹å¼ |
|------|----------|----------|----------|----------|
| **P0 - ç´§æ€¥** | æ ¸å¿ƒåŠŸèƒ½ä¸å¯ç”¨ | 5åˆ†é’Ÿ | 2å°æ—¶ | ç”µè¯+çŸ­ä¿¡+é’‰é’‰ |
| **P1 - é«˜** | éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸ | 15åˆ†é’Ÿ | 4å°æ—¶ | çŸ­ä¿¡+é’‰é’‰ |
| **P2 - ä¸­** | æ€§èƒ½ä¸‹é™ | 30åˆ†é’Ÿ | 8å°æ—¶ | é’‰é’‰+é‚®ä»¶ |
| **P3 - ä½** | è½»å¾®é—®é¢˜ | 1å°æ—¶ | 24å°æ—¶ | é‚®ä»¶ |

### åº”æ€¥å“åº”æµç¨‹

```mermaid
graph TD
    A[æ•…éšœå‘ç°] --> B{æ•…éšœåˆ†çº§}
    B -->|P0/P1| C[ç«‹å³å“åº”]
    B -->|P2/P3| D[æ­£å¸¸å“åº”]
    
    C --> E[ç»„å»ºåº”æ€¥å°ç»„]
    D --> F[åˆ†é…å¤„ç†äººå‘˜]
    
    E --> G[æ•…éšœå®šä½]
    F --> G
    
    G --> H[åˆ¶å®šè§£å†³æ–¹æ¡ˆ]
    H --> I[å®æ–½ä¿®å¤]
    I --> J[éªŒè¯ä¿®å¤æ•ˆæœ]
    
    J -->|æˆåŠŸ| K[æ•…éšœè§£é™¤]
    J -->|å¤±è´¥| L[å›æ»šæ“ä½œ]
    L --> H
    
    K --> M[æ•…éšœæ€»ç»“]
    M --> N[ä¼˜åŒ–æ”¹è¿›]
```

### å¸¸è§æ•…éšœå¤„ç†

**æœåŠ¡æ— å“åº”**
```bash
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker ps | grep vss
systemctl status vss-backend

# 2. æŸ¥çœ‹æ—¥å¿—
docker logs vss-backend --tail 100
tail -f /var/log/vss/backend.log

# 3. æ£€æŸ¥èµ„æºä½¿ç”¨
top -p $(pgrep java)
df -h
free -m

# 4. é‡å¯æœåŠ¡
docker-compose restart vss-backend
```

**æ•°æ®åº“è¿æ¥å¼‚å¸¸**
```bash
# 1. æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
docker exec -it postgres psql -U postgres -c "SELECT version();"

# 2. æ£€æŸ¥è¿æ¥æ•°
docker exec -it postgres psql -U postgres -c "SELECT count(*) FROM pg_stat_activity;"

# 3. æ£€æŸ¥æ…¢æŸ¥è¯¢
docker exec -it postgres psql -U postgres -c "SELECT query, query_start FROM pg_stat_activity WHERE state = 'active';"

# 4. é‡å¯æ•°æ®åº“
docker-compose restart postgres
```

---

## ğŸ”’ å®‰å…¨è¿ç»´

### å®‰å…¨æ£€æŸ¥æ¸…å•

- [ ] **ç³»ç»Ÿå®‰å…¨**
  - [ ] æ“ä½œç³»ç»Ÿè¡¥ä¸æ›´æ–°
  - [ ] é˜²ç«å¢™è§„åˆ™é…ç½®
  - [ ] SSHå¯†é’¥ç®¡ç†
  - [ ] ç”¨æˆ·æƒé™å®¡è®¡

- [ ] **åº”ç”¨å®‰å…¨**
  - [ ] ä¾èµ–åŒ…æ¼æ´æ‰«æ
  - [ ] APIæ¥å£å®‰å…¨æ£€æŸ¥
  - [ ] æ•°æ®åŠ å¯†éªŒè¯
  - [ ] è®¿é—®æ—¥å¿—å®¡è®¡

- [ ] **ç½‘ç»œå®‰å…¨**
  - [ ] SSLè¯ä¹¦æœ‰æ•ˆæ€§
  - [ ] ç½‘ç»œæµé‡ç›‘æ§
  - [ ] DDoSé˜²æŠ¤é…ç½®
  - [ ] å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ

### å®‰å…¨äº‹ä»¶å“åº”

```bash
# å®‰å…¨æ‰«æè„šæœ¬
#!/bin/bash

echo "å¼€å§‹å®‰å…¨æ£€æŸ¥..."

# æ£€æŸ¥å¼‚å¸¸ç™»å½•
echo "æ£€æŸ¥å¼‚å¸¸ç™»å½•..."
lastlog | grep -v "Never logged in"

# æ£€æŸ¥å¼€æ”¾ç«¯å£
echo "æ£€æŸ¥å¼€æ”¾ç«¯å£..."
netstat -tuln | grep LISTEN

# æ£€æŸ¥è¿›ç¨‹
echo "æ£€æŸ¥å¯ç–‘è¿›ç¨‹..."
ps aux | grep -E "(nc|netcat|wget|curl)" | grep -v grep

# æ£€æŸ¥æ–‡ä»¶æƒé™
echo "æ£€æŸ¥å…³é”®æ–‡ä»¶æƒé™..."
ls -la /etc/passwd /etc/shadow /etc/sudoers

echo "å®‰å…¨æ£€æŸ¥å®Œæˆ"
```

---

## ğŸ“Š å®¹é‡è§„åˆ’

### èµ„æºä½¿ç”¨è¶‹åŠ¿

| èµ„æºç±»å‹ | å½“å‰ä½¿ç”¨ | å¢é•¿ç‡ | é¢„è®¡6ä¸ªæœˆ | æ‰©å®¹å»ºè®® |
|----------|----------|--------|-----------|----------|
| **CPU** | 60% | 5%/æœˆ | 90% | å¢åŠ 2æ ¸ |
| **å†…å­˜** | 70% | 3%/æœˆ | 88% | å¢åŠ 4GB |
| **å­˜å‚¨** | 45% | 10%/æœˆ | 105% | å¢åŠ 500GB |
| **ç½‘ç»œ** | 30% | 8%/æœˆ | 78% | å‡çº§å¸¦å®½ |

### æ‰©å®¹ç­–ç•¥

**æ°´å¹³æ‰©å®¹**
```yaml
# å¢åŠ æœåŠ¡å®ä¾‹
version: '3.8'
services:
  vss-backend:
    image: vss-backend:latest
    deploy:
      replicas: 3  # ä»1å¢åŠ åˆ°3
      resources:
        limits:
          cpus: '1.0'
          memory: 2G
```

**å‚ç›´æ‰©å®¹**
```yaml
# å¢åŠ èµ„æºé…ç½®
services:
  vss-backend:
    image: vss-backend:latest
    deploy:
      resources:
        limits:
          cpus: '2.0'    # ä»1.0å¢åŠ åˆ°2.0
          memory: 4G     # ä»2Gå¢åŠ åˆ°4G
```

---

## ğŸ“– é˜…è¯»æŒ‡å—

### ğŸ”° è¿ç»´æ–°æ‰‹
1. å…ˆäº†è§£æ•´ä½“æ¶æ„å’Œç›‘æ§ä½“ç³»
2. å­¦ä¹ åŸºç¡€çš„æ•…éšœæ’æŸ¥æ–¹æ³•
3. ç†Ÿæ‚‰å¸¸ç”¨çš„è¿ç»´å·¥å…·å’Œå‘½ä»¤

### ğŸ—ï¸ è¿ç»´å·¥ç¨‹å¸ˆ
1. é‡ç‚¹å…³æ³¨ç›‘æ§å‘Šè­¦å’Œæ—¥å¿—ç®¡ç†
2. æŒæ¡æ•…éšœå¤„ç†å’Œåº”æ€¥å“åº”æµç¨‹
3. å­¦ä¹ æ€§èƒ½è°ƒä¼˜å’Œå®¹é‡è§„åˆ’

### ğŸ”’ å®‰å…¨å·¥ç¨‹å¸ˆ
1. ä¸“æ³¨å®‰å…¨è¿ç»´å’Œåˆè§„æ£€æŸ¥
2. äº†è§£å®‰å…¨äº‹ä»¶å“åº”æµç¨‹
3. æŒæ¡å®‰å…¨æ‰«æå’Œæ¼æ´ä¿®å¤

### ğŸ“Š DevOpså·¥ç¨‹å¸ˆ
1. å…³æ³¨è‡ªåŠ¨åŒ–è¿ç»´å’ŒCI/CD
2. å­¦ä¹ åŸºç¡€è®¾æ–½å³ä»£ç 
3. æŒæ¡å®¹å™¨åŒ–éƒ¨ç½²å’Œç¼–æ’

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](../01-architecture/architecture-overview.md)
- [éƒ¨ç½²è¿ç»´æŒ‡å—](../04-deployment/README.md)
- [æœåŠ¡è¯¦ç»†æ–‡æ¡£](../06-services/README.md)
- [å¼€å‘ç¯å¢ƒæŒ‡å—](../05-development/README.md)

---

## ğŸ“ è¿ç»´æ”¯æŒ

### è”ç³»æ–¹å¼
- **è¿ç»´çƒ­çº¿**: 400-XXX-XXXX
- **é’‰é’‰ç¾¤**: VSSè¿ç»´æ”¯æŒç¾¤
- **é‚®ç®±**: ops@vss-project.com

### å€¼ç­å®‰æ’
- **å·¥ä½œæ—¥**: 9:00-18:00 (ä¸“äººå€¼ç­)
- **éå·¥ä½œæ—¥**: 24å°æ—¶ (è½®ç­å€¼ç­)
- **ç´§æ€¥æƒ…å†µ**: éšæ—¶å“åº”

---

**ğŸ“ æœ€åæ›´æ–°**: 2025å¹´1æœˆ | **ğŸ‘¥ ç»´æŠ¤å›¢é˜Ÿ**: è¿ç»´å·¥ç¨‹å›¢é˜Ÿ