# VSS 项目环境配置对比

## 为什么需要多个环境配置？

### 1. 开发效率
- **开发环境**: 快速迭代，立即看到代码变更效果
- **生产环境**: 稳定可靠，注重性能和安全

### 2. 风险控制
- **开发环境**: 可以随意测试，不影响用户
- **生产环境**: 避免测试代码影响真实用户

### 3. 资源优化
- **开发环境**: 使用便宜的资源（本地数据库、简单缓存）
- **生产环境**: 使用高性能资源（集群数据库、CDN）

## 详细对比表

| 配置项 | 开发环境 | 生产环境 | 说明 |
|--------|----------|----------|------|
| **端口配置** |
| 前端端口 | 3001 | 3000 | 避免端口冲突 |
| 后端端口 | 3003 | 3002 | 不同端口便于区分 |
| 数据库端口 | 5433 | 5432 | 开发用非标准端口 |
| **安全配置** |
| JWT密钥 | `dev-jwt-secret-key` | 强随机密钥 | 开发用简单密钥 |
| CORS策略 | `*` (允许所有) | 指定域名 | 开发环境更宽松 |
| SSL | 不启用 | 启用HTTPS | 生产必须加密 |
| **数据库** |
| 类型 | H2/PostgreSQL | PostgreSQL | 开发可用内存数据库 |
| 数据 | 测试数据 | 真实数据 | 开发数据可随意删除 |
| 备份 | 不需要 | 必需 | 生产数据珍贵 |
| **日志级别** |
| 级别 | DEBUG | WARN/ERROR | 开发需要详细日志 |
| 输出 | 控制台 | 文件+监控 | 生产需要持久化 |
| **性能优化** |
| 代码压缩 | 否 | 是 | 开发便于调试 |
| 缓存 | 禁用 | 启用 | 开发需要最新代码 |
| 热重载 | 启用 | 禁用 | 开发提高效率 |
| **监控和运维** |
| 健康检查 | 简单 | 详细 | 生产需要全面监控 |
| 错误报告 | 详细 | 简化 | 开发需要调试信息 |
| 重启策略 | 手动 | 自动 | 生产需要高可用 |

## 配置文件结构

```
VSS/
├── .env                    # 基础配置（通用设置）
├── .env.development        # 开发环境专用配置
├── .env.production         # 生产环境专用配置
├── docker-compose.yml      # 生产环境Docker配置
├── docker-compose.dev.yml  # 开发环境Docker配置
└── config-manage.sh        # 配置管理脚本
```

## 使用场景示例

### 开发阶段
```bash
# 加载开发配置
./config-manage.sh load development

# 启动开发环境
./docker-manage.sh dev

# 访问地址
# 前端: http://localhost:3001
# 后端: http://localhost:3003
# 数据库管理: http://localhost:8025 (MailHog)
```

### 生产部署
```bash
# 加载生产配置
./config-manage.sh load production

# 验证生产配置安全性
./config-manage.sh validate production

# 启动生产环境
./docker-manage.sh start

# 访问地址
# 前端: http://localhost:3000
# 后端: http://localhost:3002
```

## 配置继承机制

1. **基础配置** (.env): 所有环境共用的基本设置
2. **环境配置** (.env.development/.env.production): 覆盖基础配置
3. **Docker配置**: 使用环境变量，支持默认值

这样设计的好处：
- ✅ **隔离性**: 开发和生产互不影响
- ✅ **灵活性**: 可以针对不同环境调优
- ✅ **安全性**: 生产环境有额外的安全措施
- ✅ **效率性**: 开发环境优化开发体验
- ✅ **可维护性**: 配置集中管理，易于修改

## 最佳实践

1. **永远不要在生产环境使用开发配置**
2. **定期更新生产环境的密钥和证书**
3. **使用环境变量管理敏感信息**
4. **在部署前验证配置的正确性**
5. **保持开发和生产环境的代码一致性**
